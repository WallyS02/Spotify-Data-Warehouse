<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="12/14/2023 5:26:59 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="LAPTOP-SA60QDT0"
  DTS:CreatorName="LAPTOP-SA60QDT0\toomm"
  DTS:DTSID="{0B0E08CB-20C7-4F4A-8AF5-3D53AFCB9AAB}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="16.0.5397.1"
  DTS:LocaleID="1045"
  DTS:ObjectName="Insert Data"
  DTS:PackageType="5"
  DTS:VersionBuild="9"
  DTS:VersionGUID="{7EF09473-A81D-4D2E-8A17-BE16B52DF5CF}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[LAPTOP-SA60QDT0.Spotify2]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{9D26513D-7884-4825-924D-D1D22A8F9032}"
      DTS:ObjectName="LAPTOP-SA60QDT0.Spotify2">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectRetryCount="1"
          DTS:ConnectRetryInterval="5"
          DTS:ConnectionString="Data Source=LAPTOP-SA60QDT0;Initial Catalog=Spotify2;Provider=SQLOLEDB.1;Integrated Security=SSPI;Application Name=SSIS-Package-{9D26513D-7884-4825-924D-D1D22A8F9032}LAPTOP-SA60QDT0.Spotify2;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Drop auxiliary tables"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{12B864AA-6ABE-4F10-B6C1-7C0A6DFFF88B}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Drop auxiliary tables"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9D26513D-7884-4825-924D-D1D22A8F9032}"
          SQLTask:SqlStatementSource="USE master;&#xA;GO&#xA;DROP DATABASE auxiliary;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Load auxility tables"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{7B30EF31-73B0-41DA-BD30-6D7B859DAC07}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Load auxility tables"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9D26513D-7884-4825-924D-D1D22A8F9032}"
          SQLTask:SqlStatementSource="USE master; DROP DATABASE auxiliary; CREATE DATABASE auxiliary; GO USE auxiliary; CREATE TABLE SpotifyArtistsCSV(ArtistID INT, Country VARCHAR(100), Followers INT, NumberOfTracks INT, Genre VARCHAR(100), DebutDate DATE, &#xA;TotalListeningHours DECIMAL(10, 2), AverageTrackLength DECIMAL(10, 2)); BULK INSERT  SpotifyArtistsCSV&#xA;                                                                                                                                                                  FROM      'C:\Users\Ja\Downloads\HD\Spotify-Data-Warehouse\DataGenerator\TommyGenerator\Data\dane_artysta1.csv' WITH (FIELDTERMINATOR = ',', &#xA;                                                                                                                                                                                    ROWTERMINATOR = '\n', FIRSTROW = 2, KEEPNULLS); CREATE TABLE SpotifyCustomersCSV(CustomerID INT, RegistrationDate Date, &#xA;                                                                                                                                                                                    MostListenedGenre VARCHAR(100), SongsInPrivateLibrary INT, FollowersNumber INT, LastLoginDatetime Datetime, &#xA;                                                                                                                                                                                    NumberOfDaysOfPremiumAccount INT, MostUsedDevice VARCHAR(100)); BULK INSERT SpotifyCustomersCSV&#xA;FROM     'C:\Users\Ja\Downloads\HD\Spotify-Data-Warehouse\DataGenerator\TommyGenerator\Data\dane_uzytkownik1.csv' WITH (FIELDTERMINATOR = ',', ROWTERMINATOR = '\n', FIRSTROW = 2, KEEPNULLS); &#xA;                  CREATE TABLE holidays(date DATE, name VARCHAR(500), PRIMARY KEY (date, name)); DECLARE ? INT = 2035; DECLARE ? INT = YEAR(GETDATE()); WHILE ? &lt;= ? BEGIN&#xA;                      /* Nowy Rok*/ INSERT &#xA;                      INTO        holidays(date, name)&#xA;VALUES (CAST(? AS VARCHAR(4)) + '-01-01', 'New Years Eve');&#xA;                      /* Święto Trzech Króli*/ INSERT &#xA;                      INTO        holidays(date, name)&#xA;VALUES (CAST(? AS VARCHAR(4)) + '-01-06', 'Epiphany'); /* Wielkanoc*/ DECLARE? INT,? INT,? INT,? INT,? INT;&#xA;SET          ? = ? / 100;&#xA;SET          ? = ? % 19;&#xA;SET          ? = (19 * ? + ? - ? / 4 - ((8 * ? + 13) / 25) + 15) % 30;&#xA;SET          ? = ? - ? / 28 * (1 - 29 / (? + 1) * ((21 - ?) / 11));&#xA;SET          ? = (? + ? / 4 + ? + 2 - ? + ? / 4) % 7; DECLARE ? INT, ? INT, ? INT;&#xA;SET          ? = ? - ?;&#xA;SET          ? = 3 + (? + 40) / 44;&#xA;SET          ? = ? + 28 - 31 * (? / 4); DECLARE ? DATE = CAST(? AS VARCHAR(4)) + '-' + RIGHT('0' + CAST(? AS VARCHAR(2)), 2) + '-' + RIGHT('0' + CAST(? AS VARCHAR(2)), 2);&#xA;                      INSERT  &#xA;                      INTO        holidays(date, name)&#xA;VALUES (?, 'Easter'); /* Wielkanocny Poniedziałek*/ DECLARE? DATE;&#xA;                      SELECT ? = DATEADD(DAY, 1, ?);&#xA;                                            INSERT  &#xA;                                            INTO        holidays(date, name)&#xA;VALUES (?, 'Easter monday');&#xA;                      /* Święto Pracy*/ INSERT &#xA;                      INTO        holidays(date, name)&#xA;VALUES (CAST(? AS VARCHAR(4)) + '-05-01', 'Labour Day');&#xA;                      /* Święto Konstytucji 3 Maja*/ INSERT &#xA;                      INTO        holidays(date, name)&#xA;VALUES (CAST(? AS VARCHAR(4)) + '-05-03', 'Constitution Day May 3'); /* Zielone Świątki*/ DECLARE? DATE;&#xA;                      SELECT ? = DATEADD(WEEK, 7, ?);&#xA;                                            INSERT  &#xA;                                            INTO        holidays(date, name)&#xA;VALUES (?, 'Pentecost'); /* Boże Ciało*/ DECLARE? DATE;&#xA;                      SELECT ? = DATEADD(WEEK, 10, ?);&#xA;                                            INSERT  &#xA;                                            INTO        holidays(date, name)&#xA;VALUES (?, 'Corpus Christi');&#xA;                      /* Wniebowzięcie Najświętszej Maryi Panny*/ INSERT &#xA;                      INTO        holidays(date, name)&#xA;VALUES (CAST(? AS VARCHAR(4)) + '-08-15', 'Assumption of the Blessed Virgin Mary');&#xA;                      /* Wszystkich Świętych*/ INSERT &#xA;                      INTO        holidays(date, name)&#xA;VALUES (CAST(? AS VARCHAR(4)) + '-11-01', 'All the saints');&#xA;                      /* Święto Niepodległości*/ INSERT &#xA;                      INTO        holidays(date, name)&#xA;VALUES (CAST(? AS VARCHAR(4)) + '-11-11', 'Independence Day');&#xA;                      /* Boże Narodzenie*/ INSERT &#xA;                      INTO        holidays(date, name)&#xA;VALUES (CAST(? AS VARCHAR(4)) + '-12-25', 'Christmas first day');&#xA;                      INSERT  &#xA;                      INTO        holidays(date, name)&#xA;VALUES (CAST(? AS VARCHAR(4)) + '-12-26', 'Christmas second day');&#xA;SET          ? + = 1; END;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Load Data"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{ADC6DF9B-5BF5-4556-95DD-5C9B1E9F8603}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Load Data"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9D26513D-7884-4825-924D-D1D22A8F9032}"
          SQLTask:SqlStatementSource="DECLARE @EndDate DATE = '2035-12-31';&#xA;DECLARE @CurrentDate DATE = '1970-01-01';&#xA;&#xA;WHILE @CurrentDate &lt;= @EndDate&#xA;BEGIN&#xA;    DECLARE @IsHoliday BIT;&#xA;    DECLARE @HolidayName VARCHAR(100);&#xA;&#xA;    USE auxiliary;&#xA;    SELECT @IsHoliday = CASE WHEN COUNT(*) &gt; 0 THEN 1 ELSE 0 END,&#xA;           @HolidayName = COALESCE(MAX(Name), '')&#xA;    FROM Holidays&#xA;    WHERE date = @CurrentDate;&#xA;    USE SpotifyDW;&#xA;&#xA;    INSERT INTO Date (Year, Month, Day, MonthNumber, DayOfWeek, DayOfWeekNumber, WorkingDay, Vacation, VacationType)&#xA;    SELECT&#xA;        YEAR(@CurrentDate),&#xA;        FORMAT(@CurrentDate, 'MMMM'),&#xA;        DAY(@CurrentDate),&#xA;        MONTH(@CurrentDate),&#xA;        DATENAME(WEEKDAY, @CurrentDate),&#xA;        DATEPART(WEEKDAY, @CurrentDate),&#xA;        IIF(@IsHoliday = 1, 'Free day',&#xA;            IIF(DATENAME(WEEKDAY, @CurrentDate) IN ('Saturday', 'Sunday'), 'Free day', 'Working day')) AS WorkingDay,&#xA;        IIF(MONTH(@CurrentDate) IN (7, 8), 'Summer holidays',&#xA;            IIF(MONTH(@CurrentDate) IN (1, 2), 'Winter holidays', 'No holidays')) AS Vacation,&#xA;        IIF(@IsHoliday = 1, @HolidayName, 'None') AS VacationType&#xA;    SET @CurrentDate = DATEADD(DAY, 1, @CurrentDate);&#xA;END;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Load Junk"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{E8AAABD0-4A24-48E4-B285-D864D94AC332}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Load Junk"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9D26513D-7884-4825-924D-D1D22A8F9032}"
          SQLTask:SqlStatementSource="USE SpotifyDW;&#xA;&#xA;DECLARE @ID INT, @Device CHAR(100);&#xA;&#xA;CLOSE junk_cursor;&#xA;DEALLOCATE junk_cursor;&#xA;&#xA;DECLARE junk_cursor CURSOR FOR&#xA;SELECT&#xA;    ID,&#xA;    DEVICE&#xA;FROM&#xA;    Spotify.dbo.PLAYBACK ORDER BY ID;&#xA;&#xA;OPEN junk_cursor;&#xA;FETCH NEXT FROM junk_cursor INTO @ID, @Device;&#xA;&#xA;WHILE @@FETCH_STATUS = 0&#xA;BEGIN&#xA;    IF NOT EXISTS (&#xA;        SELECT 1&#xA;        FROM Junk&#xA;        WHERE Device = @Device&#xA;    )&#xA;    BEGIN&#xA;        INSERT INTO Junk (&#xA;            Device&#xA;        )&#xA;        VALUES (&#xA;            @Device&#xA;        );&#xA;    END&#xA;&#xA;    FETCH NEXT FROM junk_cursor INTO @ID, @Device;&#xA;END;&#xA;&#xA;CLOSE junk_cursor;&#xA;DEALLOCATE junk_cursor;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Load time"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{6EBBEE0A-3D50-4BA2-A700-132B5075F9B5}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Load time"
      DTS:ThreadHint="2">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9D26513D-7884-4825-924D-D1D22A8F9032}"
          SQLTask:SqlStatementSource="USE SpotifyDW;&#xA;&#xA;DECLARE @Hour INT = 0;&#xA;DECLARE @Minute INT = 0;&#xA;DECLARE @Second INT = 0;&#xA;&#xA;WHILE @Hour &lt; 24&#xA;BEGIN&#xA;    WHILE @Minute &lt; 60&#xA;    BEGIN&#xA;        WHILE @Second &lt; 60&#xA;        BEGIN&#xA;            INSERT INTO Time (Hour, Minute, Second)&#xA;            VALUES (@Hour, @Minute, @Second);&#xA;            SET @Second = @Second + 1;&#xA;        END&#xA;        SET @Minute = @Minute + 1;&#xA;        SET @Second = 0;&#xA;    END&#xA;    SET @Hour = @Hour + 1;&#xA;    SET @Minute = 0;&#xA;END&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{66C2ADF5-9560-44C8-A294-6BDBDFF5F31F}"
      DTS:From="Package\Load auxility tables"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Load Data" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{6EF3645B-A319-48E1-97E4-35377BC0BBA2}"
      DTS:From="Package\Load Data"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\Drop auxiliary tables" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="168.8,41.6"
          Id="Package\Load auxility tables"
          TopLeft="223.571429047353,70.3529411148035" />
        <NodeLayout
          Size="125.6,41.6"
          Id="Package\Load Junk"
          TopLeft="44.2857143799869,250.823529191908" />
        <NodeLayout
          Size="124.8,41.6"
          Id="Package\Load time"
          TopLeft="470.000001000507,258.470588008735" />
        <NodeLayout
          Size="162.4,41.6"
          Id="Package\Load Data"
          TopLeft="235.000000500253,240.117646848351" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="316.371429068641,111.952941114804">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,128.164705733548"
              Start="0,0"
              End="0,120.664705733548">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,120.664705733548" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <NodeLayout
          Size="174.4,41.6"
          Id="Package\Drop auxiliary tables"
          TopLeft="230.714286205416,402.999999646755" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="317.057143352835,281.717646848351">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,121.282352798404"
              Start="0,0"
              End="0,113.782352798404">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,113.782352798404" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>